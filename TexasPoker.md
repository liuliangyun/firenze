# 德州扑克游戏规则

## 使用道具
一副标准扑克牌去掉大小王后的52张牌进行游戏。

## 游戏人数
2-10个玩家。

## 游戏目的
赢取其他玩家的筹码。

## 游戏玩家
+ 庄家：每局游戏都会有一名庄家，当一局牌局结束后，庄家按照顺时针方向下移一位。
+ 小盲注玩家：庄家左手边为小盲注玩家，在牌局开始之前，需要投下小盲注。
+ 大盲注玩家：小盲注左手边为大盲注玩家，在牌局开始之前，需要投下大盲注，一般而言，大盲注是小盲注的2倍。
+ 普通玩家：除庄家、小盲注玩家、大盲注玩家以外的其他玩家。

注：当只有两个玩家时，大盲注玩家也是庄家

## 玩家操作（表态）
+ 跟注：玩家下注，且金额跟场上的最高投注额相同。
+ 加注：玩家下注，且金额超过场上的最高投注额。
+ 过牌：玩家暂不表态，由下一个玩家进行表态。
+ 弃牌：放弃游戏。
+ All in：暂时不考虑。

## 游戏轮数
确定好小盲注和大盲注后，游戏开始，游戏一共分为4轮：
+ 第一轮，给每个玩家发两张底牌，从大盲注后的第一个人玩家开始，剩余玩家按照顺时针方向依次表态，玩家可以选择跟注、加注、弃牌。
+ 第二轮，翻出3张公共牌，由小盲注开始（如果小盲注已弃牌，由后面最近的玩家开始，以此类推），剩余玩家按照顺时针方向依次表态，玩家可以选择跟注、加
注、过牌、弃牌。
+ 第三轮，翻出第4张公共牌，由小盲注开始（如果小盲注已弃牌，由后面最近的玩家开始，以此类推），剩余玩家按照顺时针方向依次表态，玩家可以选择跟注、
加注、过牌、弃牌。
+ 第四轮，翻出第5张公共牌，由小盲注开始（如果小盲注已弃牌，由后面最近的玩家开始，以此类推），剩余玩家按照顺时针方向依次表态，玩家可以选择跟注、
加注、过牌、弃牌。

## 游戏结算
经过前面四轮，剩余的玩家开始亮牌比大小，玩家用自己的2张底牌和5张公共牌结合在一起，选出5张牌，凑成最大的成牌，成牌最大的玩家为最终赢家，赢得相应
数量的筹码。

## 比牌方法（暂时不考虑牌型相同时，点数大小的比较）
+ 牌型大小依序为：同花顺 > 四条 > 葫芦 > 同花 > 顺子 > 三条 > 两对 > 一对 > 高牌。
``` 
皇家同花顺（Royal Straight Flush）: 同花色的A，K，Q，J和10。
 Given
     玩家手牌：黑桃10,红心J
     公共牌：红心10,黑桃J,黑桃Q,黑桃K,黑桃A
 Then
     牌型为：皇家同花顺
``` 
```
同花顺（Straight Flush）: 五张同花色的连续牌。（暂时不考虑比大小，即同时有同花顺时，最大点数者为赢家）
 Given
     玩家手牌：黑桃10,红心J
     公共牌：红心10,黑桃9,黑桃8,黑桃7,黑桃6
 Then
     牌型为：同花顺
```
```
四条（Four of a kind）: 其中四张是相同点数的扑克牌，第五张是剩下牌组中最大的一张牌。（暂时不考虑比大小，即同时有四条时，先比较4条的点数，若相同再比较最后一张牌的点数）
 Given
    玩家手牌：黑桃2,红心Q
    公共牌：草花Q,黑桃Q,方块Q,黑桃3,黑桃4
 Then
    牌型为：四条
```
```
葫芦（满堂红，三带二，Full house）: 由三张相同点数及任何两张其他相同点数的扑克牌组成。（暂时不考虑比大小，即同时有葫芦时，先比较3条的点数，若相同再比较对子的点数） 
 Given
    玩家手牌：黑桃J,红心K
    公共牌：红心J,方块J,黑桃K,黑桃3,黑桃4
 Then
    牌型为：葫芦
```
```
同花（Flush）: 由五张不按顺序但相同花色的扑克牌组成。（暂时不考虑比大小，即同时有同花时，从大到小依次比较每一张牌）
 Given
    玩家手牌：黑桃J,红心4
    公共牌：红心3,黑桃10,黑桃K,黑桃3,黑桃4
 Then
    牌型为：同花
```
```
顺子（Straight）: 由五张顺序扑克牌组成。（暂时不考虑比大小，即同时有顺子时，最大点数者为赢家） 
 Given
    玩家手牌：黑桃5,红心7
    公共牌：红心8,黑桃6,草花9,黑桃2,黑桃4
 Then
    牌型为：顺子
```
```
三条（Three of a kind）: 由三张相同点数和两张不同点数的扑克牌组成。（暂时不考虑比大小，即同时有三条时，先比较3条的点数，若相同再由大到小依次比较另两张牌的点数）
 Given
    玩家手牌：黑桃6,红心10
    公共牌：红心8,黑桃10,草花10,黑桃2,黑桃4
 Then
    牌型为：三条
```
```
两对（Two pair）: 由两对数字相同但两两不同的扑克和随意的一张牌组成。（暂时不考虑比大小，即同时有两对时，先比大对子的点数，若相同再比较小对子的点数，若还是相同再比较第五张牌）
 Given
    玩家手牌：黑桃6,红心10
    公共牌：红心6,黑桃10,草花9,黑桃2,黑桃4
 Then
    牌型为：两对
```
```
一对（One pair）: 由两张相同点数的扑克牌和另三张无法组成牌型组成。（暂时不考虑比大小，即同时有一对时，先比较对子的大小，若相同，从大到小依次比较每张牌的大小）
 Given
    玩家手牌：黑桃6,红心3
    公共牌：红心6,黑桃J,草花9,黑桃2,黑桃4
 Then
    牌型为：一对
```
```
高牌（High card）: 无法组成以上任一牌型的散牌。 （暂时不考虑比大小，即同时有高牌时，从大到小依次比较每一张牌）
 Given
    玩家手牌：黑桃6,红心3
    公共牌：红心Q,黑桃J,草花9,黑桃2,黑桃4
 Then
    牌型为：高牌
```

## 规则介绍（Concept）
+ 每一轮游戏都会顺时针遍历游戏中活跃的玩家，依次表态。
```
Given
    游戏玩家: A,B,C,D
When
    游戏开始
Then
    游戏当前操作玩家：A
    游戏等待操作玩家：A,B,C,D

-------------------------------------------

Given
    游戏玩家: A,B,C,D
    游戏当前操作玩家：A
When
    玩家 A 过牌
Then
    游戏当前操作玩家：B

-------------------------------------------

Given
    游戏玩家: A,B,C,D
    游戏当前操作玩家：A
When
    玩家 A 下注
Then
    游戏当前操作玩家：B
```

+ 玩家在四轮中分别拿筹码下注，下注金额将进入底池。
```
Given
    游戏玩家: A,B,C,D
    游戏当前操作玩家：A
    游戏底池金额：0
    游戏当前投注额：0
    最低限注：1
When
    玩家 A 下注
Then
    玩家A下注金额：1
    游戏当前投注额：1
    游戏底池金额：1
``` 

+ 当所有玩家操作（表态）完成，游戏进入到下一轮。
```
Given
    游戏玩家: A,B,C,D
    游戏当前轮次：第一轮
When
    玩家 A,B,C,D 都过牌
Then
    游戏当前轮次：第二轮

-------------------------------------------

Given
    游戏玩家: A,B,C,D
    游戏当前轮次：第一轮
When
    玩家 A,B,C,D 都跟注 
Then
    游戏当前轮次：第二轮
```

+ 玩家在任意轮次中加注，其他游戏中活跃的玩家需要顺时针依次重新表态。
```
Given
    游戏玩家: A,B,C,D
    游戏当前轮次：第一轮
    游戏当前操作玩家：D
    游戏等待操作玩家：D,A,B,C
When
    玩家 D 加注
Then
    游戏当前轮次：第一轮
    游戏当前操作玩家：A
    游戏等待操作玩家：A,B,C,D
```

+ 跟注分两种情形。当场上还未有人下注时，跟注即玩家下游戏最低限注；当场上已有人下注时，跟注即玩家下与场上当前下注额相同的注。
```
Given
    游戏玩家: A,B,C,D
    游戏当前操作玩家：A
    玩家A下注额：0
    游戏底池：0
    最低限注：1
When
    玩家 A 下注
Then
    玩家A下注额：1
    游戏当前下注额：1
    游戏底池：1

-------------------------------------------

Given
    游戏玩家: A,B,C,D
    游戏当前操作玩家：A
    玩家A下注额：1
    游戏当前下注额：2
    游戏底池：5
When
    玩家 A 下注
Then
    玩家A下注额：2
    游戏当前下注额：2
    游戏底池：6（之前游戏底池5 + 玩家A下注额2 - 之前玩家A下注额1）
```

+ 玩家在任意轮次弃牌则退出游戏。
```
Given
    游戏玩家: A,B,C,D
    活跃的玩家：A，B,C,D
When
    玩家 A 弃牌
Then
    活跃的玩家：B,C,D
```

+ 当玩家的当前投注金额为游戏最高投注金额时，玩家可以过牌。
```
Given
    游戏玩家: A,B,C,D
    玩家 A 当前投注金额：20
    游戏最高投注金额：20
When
    轮到玩家 A 表态
Then
    当前可进行的操作：包括过牌
```

+ 在游戏结算前，如果只剩一位玩家，则直接进入游戏结算。
```
Given
    游戏轮次：PREFLOP/FLOP/TURN/RIVER
    游戏玩家：A,B,C,D
When
    A,B,C弃牌
Then
    游戏轮次：结算
```

+ 直到最后一轮投注结束，仍未退出的玩家进入游戏结算阶段。

+ 游戏结算阶段，如果只剩一位玩家，则该玩家成为赢家，赢得所有底池。
```
Given
    游戏玩家：A,B,C,D
    底池金额：40
When
    A,B,C弃牌
Then
    游戏轮次：结算
    玩家 D：获胜
    玩家 D 赢得：40
```

+ 游戏结算阶段，如果剩余多位玩家，则剩余玩家从手牌与河牌挑选最大的组合，进行比较。

+ 比牌时如有一人胜出，则该玩家成为赢家，获得底池内所有奖金。
```
Given
    游戏玩家：A,B,C,D
    底池金额：40
When
    A,B,C弃牌
Then
    游戏轮次：结算
    玩家 D：获胜
    玩家 D 赢得：40
```

+ 比牌时如有平局，则赢家平分底池内所有奖金。
```
Given
    活跃的玩家：A,B,C,D
    底池金额：80
When
    玩家 C,D 获胜
Then
    玩家 C 赢得：40
    玩家 C 赢得：40
```

## 以上的游戏结算没有考虑AllIn的情况，接下是有All in是怎么进行游戏结算
+ 游戏结算时，如果剩余玩家的投注金额相同，则没有All in情况。
A：20 没有All in
B：20 没有All in
C：20 没有All in
D：20 没有All in


+ 游戏结算时，如果剩余玩家的投注金额不同，则存在All in情况。
A：20 没有All in
B：20 没有All in
C：10 All in
D：15 All in 


子池金额平均数为0
剩余玩家A，B，C，D，投注金额分别减去子池金额平均数
如果剩余玩家有All in，则将剩余玩家的投注金额从小到大排序：10(C) > 15(D) > 20(A) > 20(B)，得到子池：10 10 10 10，子池金额平均数为10
如果剩余玩家没有All in，则得到子池：投注金额 * 剩余玩家数

子池金额平均数为10
剩余玩家A，B，D，投注金额分别减去子池金额平均数
如果剩余玩家有All in，则将剩余玩家的投注金额从小到达排序：5(D) > 10(A) > 10(B)，得到子池：5 5 5，子池金额平均数为5
如果剩余玩家没有All in，则得到子池：投注金额 * 剩余玩家数

子池金额平均数为5
剩余玩家A，B，投注金额分别减去子池金额平均数
如果剩余玩家有All in，则将剩余玩家的投注金额从小到达排序：5(A) > 5(B)，得到子池：...
如果剩余玩家没有All in，则得到子池：5 5



## State
### Game state
+ 游戏当前轮次：PREFLOP,FLOP,TURN,RIVER,SHOWDOWN;
+ 游戏玩家：A,B,C,D
+ 游戏底池金额：0


### Player state
+ 玩家名称：A
+ 玩家是否活跃中：是/否
+ 玩家是否已经表态：是/否

+ 玩家是否获胜：是/否
+ 玩家赢得的奖金：0
+ 玩家手牌
+ 玩家最佳组合牌型

### Round state
+ 当前轮次的当前投注金额：2
+ 当前轮次的玩家操作队列：A,B,C,D
+ 当前轮次的玩家投注情况：{A:1, B:2, C:2, D:2}




